name: 'tests Mac'

on:
  push:
    branches:
      - 'master'
  pull_request:

jobs:
  macos:

    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v2

    - name: Install dependencies
      run: |
        brew install python3 curl pkg-config sdl2 ffmpeg glm spirv-cross ninja

    - name: Build
      run: |
        export PKG_CONFIG_PATH=$PWD/venv/Lib/pkgconfig:$PKG_CONFIG_PATH
        make -j$(($(sysctl -n hw.logicalcpu)+1)) DEBUG_GPU_CAPTURE=yes MESON_BACKEND=ninja

